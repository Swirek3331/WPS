<?xml version="1.0" encoding="UTF-8"?>
<Items>
    <Item name="" identifier="deconstructorcrate" tags="crate" scale="0.5" linkable="true" pickdistance="150" showcontentsintooltip="true" impactsoundtag="impact_crate" hideconditionbar="true" waterproof="true" >
      <Deconstruct time="0.5" />

      <Fabricate time="30" suitablefabricators="fabricator">
        <RequiredItem identifier="steel" amount="32" />
      </Fabricate>

      <InventoryIcon texture="%ModDir:3239164008%/Content/Items/IC-ItemsAtlas.png" sourcerect="0,0,146,83" origin="0.5,0.5" />
      <Sprite texture="%ModDir:3239164008%/Content/Items/IC-ItemsAtlas.png" depth="0.54" sourcerect="0,0,146,83" origin="0.5,0.5" />
      <Body width="144" height="80" density="25" />
      <Holdable slots="RightHand+LeftHand" holdangle="5" holdpos="90,-110" handle1="-5,0" handle2="-5,10" aimable="false" msg="ItemMsgPickUpSelect">
        <StatusEffect type="OnActive" target="This" targetitemcomponent="ItemComponent" IsActive="true" condition="99" setvalue="true" />
      </Holdable>
      <ItemComponent IsActive="false" canbeselected="false" canbepicked="false" allowingameediting="false">
        <StatusEffect type="OnActive" target="This" targetitemcomponent="ItemComponent" condition="100" IsActive="false" setvalue="true">
          <Conditional IsContained="false" />
          <Conditional HasTag="container" targetcontainer="true" />
          <Conditional HasTag="cargocontainer" targetcontainer="true" />
        </StatusEffect>
      </ItemComponent>
      <!--Z nieznanych mi powodów gra nie chce współpracować na wyższych wartościach, to znaczy UI się rozjeżdża-->
      <ItemContainer capacity="56" slotsperrow="8" maxsize="32" canbeselected="true" selectkey="Action" hideitems="true" keepopenwhenequipped="true" movableframe="true" msg="itemmsginteractuse">
        <GuiFrame relativesize="0.4,0.6" anchor="Center" style="ItemUI" />
        <Containable items="smallitem,mediumitem" excludeditems="toolbelt,toolbox,bandolier,cargoscooter,largemobilecontainer" />
        <StatusEffect type="OnPicked" target="This">
          <Sound file="%ModDir:3239164008%/Content/Items/crate_open1.ogg" range="300" volume="2.0" loop="false" />
        </StatusEffect>
      </ItemContainer>
    </Item>

    <Item name="Refrigerated Crate" identifier="organcrate" tags="crate,refrigerated" scale="0.5" linkable="true" pickdistance="150" showcontentsintooltip="true" impactsoundtag="impact_crate" waterproof="true" fireproof="true" description="[M] REQUIRES NEUROTRAUMA - A place to store your precious transplant-ready organs" hideconditionbar="true">

      <Deconstruct time="0.5" />

      <Fabricate suitablefabricators="fabricator" requiredtime="30">
        <Item identifier="steel" amount="32"/>
        <Item identifier="potassium" amount="4"/>
        <Item identifier="phosphorus" amount="2" />
      </Fabricate>

      <Fabricate suitablefabricators="fabricator" requiredtime="15">
        <Item identifier="deconstructorcrate" />
        <Item identifier="potassium" amount="4"/>
        <Item identifier="phosphorus" amount="2" />
      </Fabricate>


      <InventoryIcon texture="%ModDir:3337851889%/Content/Items/ICMCCP-ItemsAtlas.png" sourcerect="254,1,146,83" origin="0.5,0.5" />
      <Sprite texture="%ModDir:3337851889%/Content/Items/ICMCCP-ItemsAtlas.png" depth="0.54" sourcerect="254,1,146,83" origin="0.5,0.5" />
      <BrokenSprite texture="%ModDir:3337851889%/Content/Items/ICMCCP-ItemsAtlas.png" sourcerect="401,1,106,83" origin="0.5,0.5" depth="0.54" maxcondition="99" fadein="false" />
      <Body width="144" height="80" density="25" />
      <Holdable slots="RightHand+LeftHand" holdangle="5" holdpos="90,-110" handle1="-5,0" handle2="-5,10" aimable="false" msg="ItemMsgPickUpSelect">
        <!-- damage the crate to display the broken sprite and turn the ItemComponent on when it is being held -->
        <StatusEffect type="OnActive" target="This" targetitemcomponent="ItemComponent" IsActive="true" condition="99" setvalue="true" />
      </Holdable>
      <!-- ItemComponent used to not have to resort to constantly running "Always" StatusEffects when no one is interacting with the crate -->
      <ItemComponent IsActive="false" canbeselected="false" canbepicked="false" allowingameediting="false">
        <!-- repair the item to display the original sprite again and turn the ItemComponent off if it is either not contained or it is stored in another item with the tag "container" like the crate shelfs -->
        <StatusEffect type="OnActive" target="This" targetitemcomponent="ItemComponent" condition="100" IsActive="false" setvalue="true">
          <Conditional IsContained="false" />
          <Conditional HasTag="container" targetcontainer="true" />
          <Conditional HasTag="cargocontainer" targetcontainer="true" />
        </StatusEffect>
      </ItemComponent>
      <ItemContainer capacity="56" slotsperrow="8" canbeselected="true" selectkey="Action" hideitems="true" keepopenwhenequipped="true" movableframe="true" msg="itemmsginteractuse">
        <GuiFrame relativesize="0.25,0.35" anchor="Center" style="ItemUI" />
        <Containable items="smallitem,organ" excludeditems="toolbox,cargoscooter" />
        <StatusEffect type="OnPicked" target="This">
          <Sound file="%ModDir:3239164008%/Content/Items/crate_open1.ogg" range="300" volume="2.0" loop="false" />
        </StatusEffect>
      </ItemContainer>
    </Item>
</Items>
